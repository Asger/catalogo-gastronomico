<ng-container *ngIf="cargado; else loading">
  <div class="container mt-tabla mb-7">
    <p-toast position="bottom-center"></p-toast>
    <p-toolbar styleClass="mt-5 mb-2">
      <ng-template pTemplate="left">
        <button
          pButton
          pRipple
          label="Agregar un Producto"
          icon="pi pi-plus"
          class="bg-principal mr-2"
          routerLink="/admin/nuevo-producto"
        ></button>
      </ng-template>
    </p-toolbar>
    <p-table
      #dt
      [value]="productos"
      [rows]="5"
      [paginator]="true"
      [globalFilterFields]="['nombre', 'categoria']"
      [rowHover]="true"
      dataKey="id"
      currentPageReportTemplate="Mostrando {first} a {last}, de {totalRecords} productos"
      [showCurrentPageReport]="true"
    >
      <ng-template pTemplate="caption">
        <div class="flex justify-content-between">
          <h3 class="m-0 hidden md:flex pt-2 color-principal">
            Gestión de Productos
          </h3>
          <span class="p-input-icon-left">
            <i class="pi pi-search"></i>
            <input
              pInputText
              type="text"
              (input)="dt.filterGlobal($any($event.target).value, 'contains')"
              placeholder="Buscar..."
            />
          </span>
        </div>
      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="nombre">
            Nombre <p-sortIcon field="nombre"></p-sortIcon>
          </th>
          <th>Imagen</th>
          <th pSortableColumn="categoria">
            Categoría <p-sortIcon field="categoria"></p-sortIcon>
          </th>
          <th></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-producto>
        <tr>
          <td>{{ producto.nombre }}</td>
          <td>
            <img [src]="producto.imagen" [alt]="producto.nombre" />
          </td>
          <td>{{ producto.categoria }}</td>
          <td>
            <button
              pButton
              pRipple
              icon="pi pi-pencil"
              class="p-button-rounded bg-cyan-400 text-white mr-3"
              [routerLink]="['/admin/editar-producto', producto.id]"
            ></button>
            <button
              pButton
              pRipple
              icon="pi pi-trash"
              class="p-button-rounded color-danger text-white"
              (click)="deleteProducto(producto)"
            ></button>
          </td>
        </tr>
      </ng-template>
    </p-table>
    <p-confirmDialog [style]="{ width: '650px' }"></p-confirmDialog>
  </div>
</ng-container>

<ng-template #loading>
  <p-progressSpinner
    class="flex justify-content-center align-items-center h-screen"
    strokeWidth="4"
  ></p-progressSpinner>
</ng-template>
